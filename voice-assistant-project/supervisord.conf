[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
loglevel=info
user=root

[program:express-api]
command=node /app/voice-assistant-project/orchestrator/celery-orchestrator.js
directory=/app/voice-assistant-project/orchestrator
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=NODE_ENV=production
priority=10
startsecs=5
stopwaitsecs=30
killasgroup=true

[program:celery-worker]
command=celery -A tasks worker --beat --loglevel=info --concurrency=4
directory=/app/voice-assistant-project/orchestrator
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
stopwaitsecs=60
killasgroup=true
environment=PYTHONUNBUFFERED=1,C_FORCE_ROOT=true
priority=20
startsecs=10

[group:orchestrator]
programs=express-api,celery-worker
priority=999
